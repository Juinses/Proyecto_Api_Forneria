{% extends 'base.html' %}
{% block content %}
<div class="container mt-3">

  <!-- Encabezado -->
  <div class="d-flex justify-content-between align-items-center">
    <h3><i class="bi bi-receipt"></i> Ventas</h3>
    <a href="{% url 'crear_venta' %}" class="btn btn-primary">
      <i class="bi bi-plus-lg"></i> Nueva Venta
    </a>
  </div>

  <!-- Tabla -->
  <div class="table-responsive mt-3">
    <table class="table table-hover table-striped align-middle">
      <thead>
        <tr>
          <th>ID</th>
          <th>Fecha</th>
          <th>Cliente</th>
          <th>Canal</th>
          <th>Folio</th>
          <th>Total</th>
          <th class="text-end">Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for v in ventas %}
          <tr>
            <td>{{ v.id }}</td>
            <td>{{ v.fecha|date:"Y-m-d H:i" }}</td>
            <td>{{ v.clientes.nombre }}</td>
            <td>{{ v.canal_venta }}</td>
            <td>{{ v.folio|default:"—" }}</td>
            <td>${{ v.total_con_iva|floatformat:0 }}</td>
            <td class="text-end">

              <!-- Comprobante HTML -->
              <a href="{% url 'comprobante_html' v.id %}" class="btn btn-sm btn-outline-secondary" title="Ver comprobante HTML">
                <i class="bi bi-file-earmark"></i>
              </a>

              <!-- PDF -->
              <a href="{% url 'comprobante_pdf' v.id %}" class="btn btn-sm btn-outline-danger" title="Descargar PDF">
                <i class="bi bi-filetype-pdf"></i>
              </a>

              <!-- Editar -->
              <a href="{% url 'editar_venta' v.id %}" class="btn btn-sm btn-outline-primary" title="Editar venta">
                <i class="bi bi-pencil"></i>
              </a>

              <!-- Eliminar -->
              <a href="{% url 'eliminar_venta' v.id %}" class="btn btn-sm btn-outline-danger btn-eliminar" title="Eliminar venta" data-mensaje="¿Eliminar esta venta?">
                <i class="bi bi-trash"></i>
              </a>

            </td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="7" class="text-center text-muted">
              No hay ventas registradas.
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</div>
{% endblock %}
